import{f as R,g as D,h as W,k as q,m as X,n as _,s as N,l as v,e as C,b as O,c as J,o as K,j as k,d as Q}from"./transform.B6Pbmi-0.js";import{r as y}from"./index.BVOCwoKb.js";/* empty css                                       */function U(){var e=0,o=1,s,r,u,d,p=D,b=!1,f;function n(a){return a==null||isNaN(a=+a)?f:p(u===0?.5:(a=(d(a)-s)*u,b?Math.max(0,Math.min(1,a)):a))}n.domain=function(a){return arguments.length?([e,o]=a,s=d(e=+e),r=d(o=+o),u=s===r?0:1/(r-s),n):[e,o]},n.clamp=function(a){return arguments.length?(b=!!a,n):b},n.interpolator=function(a){return arguments.length?(p=a,n):p};function m(a){return function(g){var $,c;return arguments.length?([$,c]=g,p=a($,c),n):[p(0),p(1)]}}return n.range=m(q),n.rangeRound=m(X),n.unknown=function(a){return arguments.length?(f=a,n):f},function(a){return d=a,s=a(e),r=a(o),u=s===r?0:1/(r-s),n}}function Z(e,o){return o.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function z(){var e=R(U()(D));return e.copy=function(){return Z(e,z())},W.apply(e,arguments)}function tt(e){for(var o=e.length/6|0,s=new Array(o),r=0;r<o;)s[r]="#"+e.slice(r*6,++r*6);return s}const et=e=>_(e[e.length-1]);var at=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(tt);const I=et(at),rt=(e,o,s)=>{y.useEffect(()=>{if(!o||!e.current)return;const r={top:40,right:30,bottom:90,left:90},u=950-r.left-r.right,d=550-r.top-r.bottom,p=N(e.current);p.selectAll("*").remove();const f=p.append("div").attr("id","chart-container").style("display","flex").style("flex-direction","column").style("align-items","center").append("svg").attr("width",u+r.left+r.right).attr("height",d+r.top+r.bottom),n=f.append("g").attr("id","g-container").attr("transform",`translate(${r.left}, ${r.top})`);n.append("rect").attr("id","rect-container").attr("width",u).attr("height",d).attr("fill","none").attr("stroke","#ccc").attr("stroke-width",1);const m=v().domain(C(o,t=>t["GNI pc PPP$"])).range([5,40]),a=v().domain(C(o,t=>t["Happy Score"])).range([0,u]),g=v().domain(C(o,t=>t["CO₂ pc"])).range([d,0]);function $(t){return z().domain(C(t,l=>l.HALE)).interpolator(I)}const c=$(o);n.append("g").attr("transform",`translate(0,${d})`).call(O(a).ticks(10,",f").tickSize(7).tickPadding(15)).attr("font-family","sans-serif").attr("font-size","14px"),n.append("text").attr("x",u/2).attr("y",d+60).style("font-size","20px").attr("font-family","sans-serif").style("text-anchor","middle").text("Happiness Score"),n.append("g").call(J(g).ticks(10,",f").tickSize(7).tickPadding(10)).attr("font-family","sans-serif").attr("font-size","14px"),n.append("text").attr("transform",`translate(-60, ${d/2}) rotate(-90)`).attr("text-anchor","middle").attr("font-size","18px").attr("font-family","sans-serif").text("CO₂ per capita").style("font-size","20px");const x=[1e3,25e3,5e4,75e3,15e4],h="GNI pc PPP$",P=f.append("g").attr("transform","translate(190, 340)");P.append("text").attr("x",-50).attr("y",-100).text(h).style("font-size","18px").attr("font-weight","bold").attr("font-family","sans-serif"),P.selectAll("legend-circle").data(x).join("circle").attr("cx",0).attr("cy",t=>-m(t)).attr("r",t=>m(t)).style("fill","none"),P.selectAll("legend-label").data(x).join("text").attr("x",(t,l)=>50+l*4).attr("y",(t,l)=>-2-l*17).text(t=>t).attr("alignment-baseline","middle");const H=f.append("g").attr("transform",`translate(${r.left+50}, ${r.top+d/7})`),w=z(I).domain(C(o,t=>t.HALE)),A=250,L=20,Y=v().domain(w.domain()).range([0,A]),F=O(Y).ticks(5).tickSize(6).tickFormat((t,l,S)=>K(".0f")(t)),j=H.append("g").attr("transform",`translate(0, ${L})`).call(F);j.select(".domain").remove(),j.selectAll(".tick line").attr("stroke","none"),H.append("defs").append("linearGradient").attr("id","legend-gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(w.ticks().map((t,l,S)=>({offset:`${100*l/(S.length-1)}%`,color:w(t)}))).enter().append("stop").attr("offset",t=>t.offset).attr("stop-color",t=>t.color),H.append("rect").attr("width",A).attr("height",L).style("fill","url(#legend-gradient)"),H.append("text").attr("transform",`translate(${A/2}, ${L-30})`).style("text-anchor","middle").style("font-size","18px").text("Healthy life expectancy (HALE)");const G=2;n.append("line").attr("id","ref-line").attr("x1","0%").attr("x2","87%").attr("y1",g(G)).attr("y2",g(G)).attr("stroke-width",3).attr("stroke-dasharray","4 4"),n.append("text").attr("id","ref-label").attr("x",10).attr("y",g(G)-10).style("font-weight","bold").style("font-size","16px").text("Sustainable CO2 pc.");const E=N("body").append("div").attr("class","tooltip").style("opacity",0);function B(t,l){E.transition().duration(200).style("opacity",.9),E.html(`
                <table>
                    <tr><td>Country:</td><td><strong>${l.Country}</strong></td></tr>
                    <tr><td>Year:</td><td><strong>${l.Year}</strong></td></tr>
                    <tr><td>Happiness:</td><td><strong>${l["Happy Score"].toFixed(2)}</strong></td></tr>
                    <tr><td>CO₂ pc:</td><td><strong>${l["CO₂ pc"].toFixed(2)}</strong></td></tr>
                    <tr><td>HALE:</td><td><strong>${l.HALE.toFixed(2)}</strong></td></tr>
                    <tr><td>GNI pc PPP$:</td><td><strong>${l["GNI pc PPP$"].toFixed(0)}</strong></td></tr>
                </table>
            `).attr("class","tooltip").style("left",t.pageX+10+"px").style("top",t.pageY-28+"px")}function M(){E.transition().duration(500).style("opacity",0)}function T(t){const l=o.filter(i=>+i.Year===t);N("#selected-year").remove(),n.append("text").attr("id","selected-year").attr("x",u/2).attr("y",-25).attr("text-anchor","middle").text(`Wealth, health, CO2 pp. and happiness in ${t}`);const S=n.selectAll("circle").data(l,i=>i?.Country||Math.random());S.exit().transition().duration(1e3).attr("r",0).remove();const V=S.enter().append("circle").attr("r",0).attr("cx",i=>a(i["Happy Score"])).attr("cy",i=>g(i["CO₂ pc"])).style("fill",i=>c(i.HALE)).style("stroke","lightgrey").on("mouseover",B).on("mouseout",M).transition().duration(1e3).attr("r",i=>m(i["GNI pc PPP$"]));S.merge(V).transition().duration(1e3).attr("r",i=>m(i["GNI pc PPP$"])).attr("cx",i=>a(i["Happy Score"])).attr("cy",i=>g(i["CO₂ pc"]))}return s(()=>T),()=>{p.selectAll("*").remove()}},[o,e,s])},dt=({csvPath:e})=>{const o=y.useRef(null),[s,r]=y.useState(null),[u,d]=y.useState(!0),[p,b]=y.useState(null),[f,n]=y.useState(()=>()=>{}),[m,a]=y.useState(null);if(rt(o,s,n),y.useEffect(()=>{async function c(){try{const x=await Q(e,h=>({Country:h.Country,Year:+h.Year,SDGi:+h.SDGi,HDI:+h.HDI,"CO₂ pc":+h["CO₂ pc"],"Happy Score":+h["Happy Score"]}));r(x)}catch(x){console.error("Failed to load CSV:",x),b("Failed to load data")}finally{d(!1)}}c()},[e]),y.useEffect(()=>{s&&f&&f(2019)},[s,f]),u)return k.jsx("p",{children:"Loading..."});if(p)return k.jsx("p",{children:p});if(!s)return null;const g=[...new Set(s.map(c=>c.Year))].sort((c,x)=>c-x),$=c=>{a(c),f(c)};return k.jsxs("div",{className:"flex gap-8",children:[k.jsx("div",{ref:o,className:"flex-1"}),k.jsx("div",{className:"mt-10 flex flex-col gap-2",children:g.map(c=>k.jsx("button",{onClick:()=>$(c),className:`year-button ${m===c?"active":""}`,disabled:!f,children:c},c))})]})};export{dt as default};
