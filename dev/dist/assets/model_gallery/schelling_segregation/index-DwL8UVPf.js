import{l as R}from"../../loadComponents-IR4gVqQb.js";import{s as A}from"../../transform-D0hhaYzD.js";const B=[{name:"navbar",targetId:"navbar"},{name:"footer",targetId:"footer"},{name:"model_drawer",targetId:"model_drawer"}];R(B);function k(M,P={}){let s=[];const p="#c63121",y="#01799e",b="#97deaa",d="#FFFFFF",u=[p,y,b],h=A(M).append("svg").attr("width",350).attr("height",350);function g(){s=[];const o=document.getElementById("vacancy").value/100,t=(1-o)/3;for(let n=0;n<32;n++){s[n]=[];for(let i=0;i<32;i++){const l=Math.random();l<o?s[n][i]=d:l<o+t?s[n][i]=p:l<o+2*t?s[n][i]=y:s[n][i]=b}}x(),v()}function x(){h.selectAll("rect").data(s.flat()).join("rect").attr("x",(o,t)=>t%32*10.9375).attr("y",(o,t)=>Math.floor(t/32)*10.9375).attr("width",10.9375).attr("height",10.9375).attr("fill",o=>o).attr("stroke","#FFF").attr("stroke-width",1).attr("class","cell")}function m(o,t,n){let i=0,l=0;for(let e=-1;e<=1;e++)for(let r=-1;r<=1;r++){if(e===0&&r===0)continue;const c=(o+e+32)%32,a=(t+r+32)%32;s[c][a]!==d&&(l++,s[c][a]===n&&i++)}return l===0?0:i/l}function j(o,t){const n=s[o][t];let i=[];for(let e=0;e<32;e++)for(let r=0;r<32;r++)s[e][r]===d&&i.push([e,r]);for(let e=i.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[i[e],i[r]]=[i[r],i[e]]}const l=document.getElementById("threshold").value/100;for(let[e,r]of i)if(m(e,r,n)>=l)return s[e][r]=n,s[o][t]=d,w(o,t,e,r,n),!0;return!1}function w(o,t,n,i,l){const e=h.select(`rect[x="${o*10.9375}"][y="${t*10.9375}"]`),r=h.select(`rect[x="${n*10.9375}"][y="${i*10.9375}"]`);e.transition().duration(100).attr("fill",d),r.transition().duration(100).attr("fill",l)}function S(){let o=[];for(let t=0;t<32;t++)for(let n=0;n<32;n++)s[t][n]!==d&&o.push([t,n]);for(let t=o.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[o[t],o[n]]=[o[n],o[t]]}return o}async function F(){const o=document.getElementById("threshold").value/100;let t=!1,n=32*32,i=0;for(;i<n;){t=!1;const l=S();for(let[e,r]of l){const c=s[e][r];if(m(e,r,c)<o&&j(e,r)){t=!0,await new Promise(f=>setTimeout(f,10)),v();break}}if(!t)break;i++}i===n&&console.log("Max iterations reached. Simulation stopped.")}function C(){let o=0,t=0;const n=document.getElementById("threshold").value/100;for(let i=0;i<32;i++)for(let l=0;l<32;l++){if(s[i][l]===d)continue;t++;const e=s[i][l];m(i,l,e)<n&&o++}return o/t*100}function E(){let o={},t=0,n=[];for(let l of u)o[l]=0;for(let l=0;l<32;l++)for(let e=0;e<32;e++){if(s[l][e]===d)continue;let r={};for(let a of u)r[a]=0;let c=0;for(let a=Math.max(0,l-1);a<=Math.min(31,l+1);a++)for(let f=Math.max(0,e-1);f<=Math.min(31,e+1);f++)if(s[a][f]!==d){const I=s[a][f];r[I]++,o[I]++,c++}c>0&&n.push({groupCounts:r,localAgentCount:c})}const i=Object.values(o).reduce((l,e)=>l+e,0);for(let{groupCounts:l,localAgentCount:e}of n)for(let r of u){const c=l[r]/e,a=o[r]/i;t+=Math.abs(c-a)}return t/(2*n.length)}function v(){const o=C(),t=E();document.getElementById("unhappiness-value").textContent=o.toFixed(1),document.getElementById("dissimilarity-value").textContent=t.toFixed(2)}return g(),{initializeGrid:g,runModel:F,resetGrid:g}}const G="#chart",z=k(G);document.getElementById("start-button").addEventListener("click",()=>{z.initializeGrid(),z.runModel()});document.getElementById("reset-button").addEventListener("click",()=>{z.resetGrid()});
